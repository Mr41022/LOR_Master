rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // General rule for authenticated users
    match /{document=**} {
      allow read, write: if request.auth != null;
    }

    // Rules for Students
    match /students/{studentID} {
      allow read, update: if request.auth != null 
                          && request.auth.token.role == 'student' 
                          && request.auth.uid == studentID;
    }

    // Rules for Faculty
    match /faculty/{facultyID} {
      allow read, update: if request.auth != null 
                          && request.auth.token.role == 'faculty' 
                          && request.auth.uid == facultyID;
    }

    // Rules for Principal
    match /principal/{principalID} {
      allow read, update: if request.auth != null 
                          && request.auth.token.role == 'principal' 
                          && request.auth.uid == principalID;
    }

    // Rules for HOD
    match /hod/{hodID} {
      allow read, update: if request.auth != null 
                          && request.auth.token.role == 'hod' 
                          && request.auth.uid == hodID;
    }
  }
}
